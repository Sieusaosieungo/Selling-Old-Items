{"version":3,"sources":["pages/Profile/index.js"],"names":["Option","Select","connect","user","withCookies","cookies","dispatch","useState","userInfo","setUserInfo","disabled","setDisabled","changePassword","setChangePassword","accessToken","onChange","e","target","name","value","gender","useEffect","className","full_name","email","student_id","phone","address","checked","type","onClick","oldPassword","message","warning","newPassword","confirmNewPassword","JSON","stringify","axios","method","url","config","API_URL","headers","authorization","data","then","res","results","storeUser","success","catch","err","error"],"mappings":"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","file":"static/js/14.e8147b8b.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Input, DatePicker, Button, message, Select, Checkbox } from 'antd';\r\nimport { connect } from 'react-redux';\r\nimport axios from 'axios';\r\nimport { withCookies } from 'react-cookie';\r\n\r\nimport './style.scss';\r\n\r\nimport config from '../../utils/config';\r\nimport { storeUser } from '../../actions';\r\n\r\nconst { Option } = Select;\r\n\r\nconst prefixCls = 'profile';\r\n\r\nconst Profile = ({ user, cookies, dispatch }) => {\r\n  const [userInfo, setUserInfo] = useState({});\r\n  const [disabled, setDisabled] = useState(true);\r\n  const [changePassword, setChangePassword] = useState(false);\r\n\r\n  const { accessToken } = cookies.cookies;\r\n\r\n  const onChange = e => {\r\n    if (e.target) {\r\n      const { name, value } = e.target;\r\n      setUserInfo({ ...userInfo, [name]: value });\r\n    } else {\r\n      setUserInfo({ ...userInfo, gender: e });\r\n    }\r\n  };\r\n\r\n  const handleChangePassword = e => setChangePassword(e.target.checked);\r\n\r\n  const cancelUpdate = () => {\r\n    setChangePassword(false);\r\n    setDisabled(true);\r\n  };\r\n\r\n  const updateUserInfo = () => {\r\n    if (disabled) {\r\n      setDisabled(false);\r\n    }\r\n\r\n    if (changePassword) {\r\n      if (!userInfo.oldPassword) {\r\n        return message.warning('Không được bỏ trống mật khẩu cũ !');\r\n      }\r\n\r\n      if (userInfo.oldPassword && !userInfo.newPassword) {\r\n        return message.warning('Không được bỏ trống mật khẩu mới');\r\n      }\r\n\r\n      if (userInfo.newPassword && !userInfo.confirmNewPassword) {\r\n        return message.warning('Không được bỏ trống xác nhận mật khẩu mới');\r\n      }\r\n    }\r\n\r\n    if (JSON.stringify(userInfo) !== JSON.stringify(user)) {\r\n      delete userInfo.email;\r\n      delete userInfo.student_id;\r\n\r\n      axios({\r\n        method: 'PATCH',\r\n        url: `${config.API_URL}/users`,\r\n        headers: {\r\n          authorization: `Bearer ${accessToken}`,\r\n        },\r\n        data: userInfo,\r\n      })\r\n        .then(res => {\r\n          if (res.data.results.user) {\r\n            dispatch(storeUser(res.data.results.user));\r\n            setChangePassword(false);\r\n            setDisabled(true);\r\n            message.success('Đổi thông tin thành công !');\r\n          }\r\n        })\r\n        .catch(err => message.error('Đổi thông tin không thành công !'));\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    setUserInfo(user);\r\n  }, [user]);\r\n\r\n  // console.log(userInfo);\r\n\r\n  return (\r\n    <div className={`${prefixCls}`}>\r\n      <p>Thông tin tài khoản</p>\r\n      <div className={`${prefixCls}-info`}>\r\n        <div className={`${prefixCls}-name`}>\r\n          <span>Họ tên:</span>\r\n          <Input\r\n            value={userInfo.full_name}\r\n            name=\"full_name\"\r\n            onChange={onChange}\r\n            disabled={disabled}\r\n          />\r\n        </div>\r\n        <div className={`${prefixCls}-email`}>\r\n          <span>Email:</span>\r\n          <Input\r\n            value={userInfo.email}\r\n            name=\"email\"\r\n            onChange={onChange}\r\n            disabled\r\n          />\r\n        </div>\r\n        <div className={`${prefixCls}-gender`}>\r\n          <span>Giới tính:</span>\r\n          <Select\r\n            name=\"gender\"\r\n            value={`${userInfo.gender}`}\r\n            onChange={onChange}\r\n            disabled={disabled}\r\n          >\r\n            <Option value=\"male\">Male</Option>\r\n            <Option value=\"female\">Female</Option>\r\n          </Select>\r\n        </div>\r\n        <div className={`${prefixCls}-student-id`}>\r\n          <span>Mã sinh viên:</span>\r\n          <Input value={userInfo.student_id} onChange={onChange} disabled />\r\n        </div>\r\n        <div className={`${prefixCls}-phone`}>\r\n          <span>Sđt:</span>\r\n          <Input\r\n            value={userInfo.phone}\r\n            name=\"phone\"\r\n            onChange={onChange}\r\n            disabled={disabled}\r\n          />\r\n        </div>\r\n        <div className={`${prefixCls}-address`}>\r\n          <span>Địa chỉ:</span>\r\n          <Input\r\n            value={userInfo.address}\r\n            name=\"address\"\r\n            onChange={onChange}\r\n            disabled={disabled}\r\n          />\r\n        </div>\r\n        {!disabled && (\r\n          <div className={`${prefixCls}-checkbox`}>\r\n            <span>Đổi mật khẩu</span>\r\n            <Checkbox onChange={handleChangePassword} />\r\n          </div>\r\n        )}\r\n        {changePassword && (\r\n          <div className={`${prefixCls}-old-password`}>\r\n            <span>Mật khẩu cũ (*):</span>\r\n            <Input type=\"password\" onChange={onChange} name=\"oldPassword\" />\r\n          </div>\r\n        )}\r\n        {changePassword && (\r\n          <div className={`${prefixCls}-new-password`}>\r\n            <span>Mật khẩu mới:</span>\r\n            <Input type=\"password\" onChange={onChange} name=\"newPassword\" />\r\n          </div>\r\n        )}\r\n        {changePassword && (\r\n          <div className={`${prefixCls}-confirm-new-password`}>\r\n            <span>Xác nhận mật khẩu mới:</span>\r\n            <Input\r\n              type=\"password\"\r\n              onChange={onChange}\r\n              name=\"confirmNewPassword\"\r\n            />\r\n          </div>\r\n        )}\r\n        <div className={`${prefixCls}-button`}>\r\n          <Button\r\n            type=\"primary\"\r\n            onClick={updateUserInfo}\r\n            className={`${prefixCls}-${!disabled ? 'btn-update' : 'btn'}`}\r\n          >\r\n            Cập nhật thông tin\r\n          </Button>\r\n          {!disabled && (\r\n            <Button\r\n              type=\"danger\"\r\n              className={`${prefixCls}-btn-cancel`}\r\n              onClick={cancelUpdate}\r\n            >\r\n              Hủy\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = ({ user }) => {\r\n  return { user };\r\n};\r\n\r\nexport default connect(mapStateToProps)(withCookies(Profile));\r\n"],"sourceRoot":""}