{"version":3,"sources":["pages/Profile/index.js"],"names":["Option","Select","connect","user","withCookies","cookies","dispatch","useState","userInfo","setUserInfo","disabled","setDisabled","changePassword","setChangePassword","accessToken","onChange","e","target","name","value","gender","useEffect","className","full_name","email","student_id","phone","address","checked","type","onClick","oldPassword","message","warning","newPassword","confirmNewPassword","JSON","stringify","axios","method","url","config","API_URL","headers","authorization","data","then","res","results","storeUser","success","catch","err","error"],"mappings":"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","file":"static/js/14.81582057.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Input, DatePicker, Button, message, Select, Checkbox } from 'antd';\nimport { connect } from 'react-redux';\nimport axios from 'axios';\nimport { withCookies } from 'react-cookie';\n\nimport './style.scss';\n\nimport config from '../../utils/config';\nimport { storeUser } from '../../actions';\n\nconst { Option } = Select;\n\nconst prefixCls = 'profile';\n\nconst Profile = ({ user, cookies, dispatch }) => {\n  const [userInfo, setUserInfo] = useState({});\n  const [disabled, setDisabled] = useState(true);\n  const [changePassword, setChangePassword] = useState(false);\n\n  const { accessToken } = cookies.cookies;\n\n  const onChange = e => {\n    if (e.target) {\n      const { name, value } = e.target;\n      setUserInfo({ ...userInfo, [name]: value });\n    } else {\n      setUserInfo({ ...userInfo, gender: e });\n    }\n  };\n\n  const handleChangePassword = e => setChangePassword(e.target.checked);\n\n  const cancelUpdate = () => {\n    setChangePassword(false);\n    setDisabled(true);\n  };\n\n  const updateUserInfo = () => {\n    if (disabled) {\n      setDisabled(false);\n    }\n\n    if (changePassword) {\n      if (!userInfo.oldPassword) {\n        return message.warning('Không được bỏ trống mật khẩu cũ !');\n      }\n\n      if (userInfo.oldPassword && !userInfo.newPassword) {\n        return message.warning('Không được bỏ trống mật khẩu mới');\n      }\n\n      if (userInfo.newPassword && !userInfo.confirmNewPassword) {\n        return message.warning('Không được bỏ trống xác nhận mật khẩu mới');\n      }\n    }\n\n    if (JSON.stringify(userInfo) !== JSON.stringify(user)) {\n      delete userInfo.email;\n      delete userInfo.student_id;\n\n      axios({\n        method: 'PATCH',\n        url: `${config.API_URL}/users`,\n        headers: {\n          authorization: `Bearer ${accessToken}`,\n        },\n        data: userInfo,\n      })\n        .then(res => {\n          if (res.data.results.user) {\n            dispatch(storeUser(res.data.results.user));\n            setChangePassword(false);\n            setDisabled(true);\n            message.success('Đổi thông tin thành công !');\n          }\n        })\n        .catch(err => message.error('Đổi thông tin không thành công !'));\n    }\n  };\n\n  useEffect(() => {\n    setUserInfo(user);\n  }, [user]);\n\n  // console.log(userInfo);\n\n  return (\n    <div className={`${prefixCls}`}>\n      <p>Thông tin tài khoản</p>\n      <div className={`${prefixCls}-info`}>\n        <div className={`${prefixCls}-name`}>\n          <span>Họ tên:</span>\n          <Input\n            value={userInfo.full_name}\n            name=\"full_name\"\n            onChange={onChange}\n            disabled={disabled}\n          />\n        </div>\n        <div className={`${prefixCls}-email`}>\n          <span>Email:</span>\n          <Input\n            value={userInfo.email}\n            name=\"email\"\n            onChange={onChange}\n            disabled\n          />\n        </div>\n        <div className={`${prefixCls}-gender`}>\n          <span>Giới tính:</span>\n          <Select\n            name=\"gender\"\n            value={`${userInfo.gender}`}\n            onChange={onChange}\n            disabled={disabled}\n          >\n            <Option value=\"male\">Male</Option>\n            <Option value=\"female\">Female</Option>\n          </Select>\n        </div>\n        <div className={`${prefixCls}-student-id`}>\n          <span>Mã sinh viên:</span>\n          <Input value={userInfo.student_id} onChange={onChange} disabled />\n        </div>\n        <div className={`${prefixCls}-phone`}>\n          <span>Sđt:</span>\n          <Input\n            value={userInfo.phone}\n            name=\"phone\"\n            onChange={onChange}\n            disabled={disabled}\n          />\n        </div>\n        <div className={`${prefixCls}-address`}>\n          <span>Địa chỉ:</span>\n          <Input\n            value={userInfo.address}\n            name=\"address\"\n            onChange={onChange}\n            disabled={disabled}\n          />\n        </div>\n        {!disabled && (\n          <div className={`${prefixCls}-checkbox`}>\n            <span>Đổi mật khẩu</span>\n            <Checkbox onChange={handleChangePassword} />\n          </div>\n        )}\n        {changePassword && (\n          <div className={`${prefixCls}-old-password`}>\n            <span>Mật khẩu cũ (*):</span>\n            <Input type=\"password\" onChange={onChange} name=\"oldPassword\" />\n          </div>\n        )}\n        {changePassword && (\n          <div className={`${prefixCls}-new-password`}>\n            <span>Mật khẩu mới:</span>\n            <Input type=\"password\" onChange={onChange} name=\"newPassword\" />\n          </div>\n        )}\n        {changePassword && (\n          <div className={`${prefixCls}-confirm-new-password`}>\n            <span>Xác nhận mật khẩu mới:</span>\n            <Input\n              type=\"password\"\n              onChange={onChange}\n              name=\"confirmNewPassword\"\n            />\n          </div>\n        )}\n        <div className={`${prefixCls}-button`}>\n          <Button\n            type=\"primary\"\n            onClick={updateUserInfo}\n            className={`${prefixCls}-${!disabled ? 'btn-update' : 'btn'}`}\n          >\n            Cập nhật thông tin\n          </Button>\n          {!disabled && (\n            <Button\n              type=\"danger\"\n              className={`${prefixCls}-btn-cancel`}\n              onClick={cancelUpdate}\n            >\n              Hủy\n            </Button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = ({ user }) => {\n  return { user };\n};\n\nexport default connect(mapStateToProps)(withCookies(Profile));\n"],"sourceRoot":""}