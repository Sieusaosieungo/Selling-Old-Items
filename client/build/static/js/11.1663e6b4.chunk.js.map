{"version":3,"sources":["utils/formatPrice.js","pages/ProductDetail/index.js"],"names":["numberToNumberWithCommas","x","toString","replace","TextArea","Input","prefixCls","CommentList","comments","dataSource","header","length","itemLayout","renderItem","props","Editor","onChange","onSubmit","submitting","value","Item","rows","htmlType","loading","onClick","type","connect","user","withCookies","id","match","params","cookies","useState","stateComment","setStateComment","productItem","setProductItem","console","log","accessToken","useEffect","axios","method","url","config","API_URL","then","res","data","results","product","catch","err","JSON","stringify","className","infiniteLoop","autoPlay","transitionTime","imageToShows","result","map","imageToShow","index","key","src","API_IMAGES","alt","renderListImage","attachImages","mainImage","name","cost","headers","authorization","product_id","point","allowHalf","averagePoint","description","message","success","warning","comment","avatar","IMAGE_USER_DEFAULT","datetime","moment","Date","fromNow","style","margin","width","borderTop","full_name","content","e","target","setTimeout"],"mappings":"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","file":"static/js/11.1663e6b4.chunk.js","sourcesContent":["export const numberToNumberWithCommas = x => {\r\n  return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\r\n};\r\n\r\nexport const numberWithNonCommasToNumber = x => {\r\n  return x.split(',').join('');\r\n};\r\n","import React, { useEffect, Fragment, useState } from 'react';\r\nimport { withCookies } from 'react-cookie';\r\nimport moment from 'moment';\r\nimport axios from 'axios';\r\nimport { connect } from 'react-redux';\r\nimport { Carousel } from 'react-responsive-carousel';\r\nimport {\r\n  Comment,\r\n  Avatar,\r\n  Form,\r\n  Button,\r\n  List,\r\n  Input,\r\n  Rate,\r\n  message,\r\n} from 'antd';\r\n\r\nimport './style.scss';\r\n\r\nimport config from '../../utils/config';\r\nimport Loading from '../../components/Loading';\r\nimport { numberToNumberWithCommas } from '../../utils/formatPrice';\r\n\r\nconst { TextArea } = Input;\r\n\r\nconst prefixCls = 'product-detail';\r\n\r\nconst CommentList = ({ comments }) => (\r\n  <List\r\n    dataSource={comments}\r\n    header={`${comments.length} ${comments.length > 1 ? 'replies' : 'reply'}`}\r\n    itemLayout=\"horizontal\"\r\n    renderItem={props => <Comment {...props} />}\r\n  />\r\n);\r\n\r\nconst Editor = ({ onChange, onSubmit, submitting, value }) => (\r\n  <div>\r\n    <Form.Item>\r\n      <TextArea rows={4} onChange={onChange} value={value} />\r\n    </Form.Item>\r\n    <Form.Item>\r\n      <Button\r\n        htmlType=\"submit\"\r\n        loading={submitting}\r\n        onClick={onSubmit}\r\n        type=\"primary\"\r\n      >\r\n        Bình luận\r\n      </Button>\r\n    </Form.Item>\r\n  </div>\r\n);\r\n\r\nconst renderListImage = imageToShows => {\r\n  let result = null;\r\n\r\n  if (imageToShows && imageToShows.length > 0) {\r\n    result = imageToShows.map((imageToShow, index) => (\r\n      <div key={index}>\r\n        <img src={`${config.API_IMAGES}${imageToShow}`} alt=\"Attach image\" />\r\n      </div>\r\n    ));\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nconst ProductDetail = ({\r\n  match: {\r\n    params: { id },\r\n  },\r\n  cookies,\r\n  user,\r\n}) => {\r\n  const [stateComment, setStateComment] = useState({\r\n    submitting: false,\r\n    value: '',\r\n  });\r\n  const [productItem, setProductItem] = useState({});\r\n\r\n  console.log(productItem);\r\n\r\n  const { accessToken } = cookies.cookies;\r\n\r\n  const handleSubmit = () => {\r\n    if (!stateComment.value) {\r\n      return;\r\n    }\r\n\r\n    setStateComment({\r\n      ...stateComment,\r\n      submitting: true,\r\n    });\r\n\r\n    setTimeout(() => {\r\n      setStateComment({\r\n        submitting: false,\r\n        value: '',\r\n      });\r\n    }, 500);\r\n\r\n    axios({\r\n      method: 'PATCH',\r\n      url: `${config.API_URL}/products/add-comment`,\r\n      headers: {\r\n        authorization: `Bearer ${accessToken}`,\r\n      },\r\n      data: {\r\n        product_id: id,\r\n        content: stateComment.value,\r\n        datetime: new Date(),\r\n      },\r\n    })\r\n      .then(res => {\r\n        setProductItem(res.data.results.product);\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  const handleChange = e => {\r\n    setStateComment({\r\n      ...stateComment,\r\n      value: e.target.value,\r\n    });\r\n  };\r\n\r\n  const handleRate = value => {\r\n    axios({\r\n      method: 'PATCH',\r\n      url: `${config.API_URL}/products/rating`,\r\n      headers: {\r\n        authorization: `Bearer ${accessToken}`,\r\n      },\r\n      data: {\r\n        product_id: id,\r\n        point: value,\r\n      },\r\n    })\r\n      .then(res => {\r\n        setProductItem(res.data.results.product);\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  const handleAddToCart = () => {\r\n    axios({\r\n      method: 'POST',\r\n      url: `${config.API_URL}/products/add-to-cart`,\r\n      headers: {\r\n        authorization: `Bearer ${accessToken}`,\r\n      },\r\n      data: {\r\n        product_id: id,\r\n      },\r\n    })\r\n      .then(res => {\r\n        message.success(`Thêm sản phẩm vào giỏ hàng thành công !`);\r\n      })\r\n      .catch(err => {\r\n        if (accessToken) {\r\n          message.warning('Sản phẩm đã có trong giỏ hàng !');\r\n        } else {\r\n          message.warning('Cần đăng nhập để thêm vào giỏ hàng !');\r\n        }\r\n      });\r\n  };\r\n\r\n  useEffect(() => {\r\n    axios({\r\n      method: 'GET',\r\n      url: `${config.API_URL}/products/${id}`,\r\n    })\r\n      .then(res => {\r\n        if (res.data.results.product) {\r\n          setProductItem(res.data.results.product);\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n  }, [id]);\r\n\r\n  if (JSON.stringify({}) !== JSON.stringify(productItem)) {\r\n    return (\r\n      <Fragment>\r\n        <div className={`${prefixCls}`}>\r\n          <div className={`${prefixCls}-image`}>\r\n            <Carousel infiniteLoop autoPlay transitionTime>\r\n              {renderListImage([\r\n                ...productItem.attachImages,\r\n                productItem.mainImage,\r\n              ])}\r\n            </Carousel>\r\n          </div>\r\n          <div className={`${prefixCls}-info`}>\r\n            <div className={`${prefixCls}-title`}>{productItem.name}</div>\r\n            <div className={`${prefixCls}-price`}>{`${numberToNumberWithCommas(\r\n              productItem.cost,\r\n            )}đ`}</div>\r\n            <div className={`${prefixCls}-rate`}>\r\n              <Rate\r\n                onChange={handleRate}\r\n                allowHalf\r\n                value={productItem.averagePoint}\r\n              />\r\n            </div>\r\n            <div className={`${prefixCls}-description`}>\r\n              <span>Mô tả:</span>\r\n              <p>{productItem.description}</p>\r\n            </div>\r\n            <div className={`${prefixCls}-quantity`}>\r\n              <Button onClick={handleAddToCart} type=\"primary\">\r\n                Thêm vào giỏ\r\n              </Button>\r\n            </div>\r\n          </div>\r\n          <div className={`${prefixCls}-comment`}>\r\n            {productItem.comments.length > 0 ? (\r\n              <CommentList\r\n                comments={productItem.comments.map(comment => ({\r\n                  ...comment,\r\n                  avatar: comment.avatar || config.IMAGE_USER_DEFAULT,\r\n                  datetime: moment(new Date(comment.datetime)).fromNow(),\r\n                }))}\r\n              />\r\n            ) : (\r\n              <div\r\n                style={{\r\n                  margin: '2rem auto 3rem',\r\n                  width: '80%',\r\n                  borderTop: '1px solid rgb(202, 202, 202)',\r\n                }}\r\n              ></div>\r\n            )}\r\n            <Comment\r\n              avatar={\r\n                <Avatar\r\n                  src={\r\n                    `${config.API_IMAGES}${user.avatar}` ||\r\n                    config.IMAGE_USER_DEFAULT\r\n                  }\r\n                  alt={user.full_name}\r\n                />\r\n              }\r\n              content={\r\n                <Editor\r\n                  onChange={handleChange}\r\n                  onSubmit={handleSubmit}\r\n                  submitting={stateComment.submitting}\r\n                  value={stateComment.value}\r\n                />\r\n              }\r\n            />\r\n          </div>\r\n        </div>\r\n      </Fragment>\r\n    );\r\n  } else {\r\n    return <Loading />;\r\n  }\r\n};\r\n\r\nconst mapStateToProps = ({ user }) => {\r\n  return { user };\r\n};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  null,\r\n)(withCookies(ProductDetail));\r\n"],"sourceRoot":""}