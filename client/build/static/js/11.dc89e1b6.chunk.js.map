{"version":3,"sources":["utils/formatPrice.js","pages/ProductDetail/index.js"],"names":["numberToNumberWithCommas","x","toString","replace","TextArea","Input","prefixCls","CommentList","comments","dataSource","header","length","itemLayout","renderItem","props","Editor","onChange","onSubmit","submitting","value","Item","rows","htmlType","loading","onClick","type","connect","user","dispatch","withCookies","id","match","params","cookies","useState","stateComment","setStateComment","productItem","setProductItem","console","log","accessToken","useEffect","axios","method","url","config","API_URL","then","res","data","results","product","catch","err","JSON","stringify","className","infiniteLoop","autoPlay","transitionTime","imageToShows","result","map","imageToShow","index","key","src","API_IMAGES","alt","renderListImage","attachImages","mainImage","name","cost","Object","keys","headers","authorization","product_id","point","updateState","isShowModalSignIn","allowHalf","averagePoint","description","message","success","warning","comment","avatar","IMAGE_USER_DEFAULT","datetime","moment","Date","fromNow","style","margin","width","borderTop","full_name","content","e","target","setTimeout"],"mappings":"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","file":"static/js/11.dc89e1b6.chunk.js","sourcesContent":["export const numberToNumberWithCommas = x => {\r\n  return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\r\n};\r\n\r\nexport const numberWithNonCommasToNumber = x => {\r\n  return x.split(',').join('');\r\n};\r\n","import React, { useEffect, Fragment, useState } from 'react';\r\nimport { withCookies } from 'react-cookie';\r\nimport moment from 'moment';\r\nimport axios from 'axios';\r\nimport { connect } from 'react-redux';\r\nimport { Carousel } from 'react-responsive-carousel';\r\nimport {\r\n  Comment,\r\n  Avatar,\r\n  Form,\r\n  Button,\r\n  List,\r\n  Input,\r\n  Rate,\r\n  message,\r\n} from 'antd';\r\n\r\nimport './style.scss';\r\n\r\nimport config from '../../utils/config';\r\nimport Loading from '../../components/Loading';\r\nimport { numberToNumberWithCommas } from '../../utils/formatPrice';\r\nimport { updateState } from '../../actions';\r\n\r\nconst { TextArea } = Input;\r\n\r\nconst prefixCls = 'product-detail';\r\n\r\nconst CommentList = ({ comments }) => (\r\n  <List\r\n    dataSource={comments}\r\n    header={`${comments.length} ${comments.length > 1 ? 'replies' : 'reply'}`}\r\n    itemLayout=\"horizontal\"\r\n    renderItem={props => <Comment {...props} />}\r\n  />\r\n);\r\n\r\nconst Editor = ({ onChange, onSubmit, submitting, value }) => (\r\n  <div>\r\n    <Form.Item>\r\n      <TextArea rows={4} onChange={onChange} value={value} />\r\n    </Form.Item>\r\n    <Form.Item>\r\n      <Button\r\n        htmlType=\"submit\"\r\n        loading={submitting}\r\n        onClick={onSubmit}\r\n        type=\"primary\"\r\n      >\r\n        Bình luận\r\n      </Button>\r\n    </Form.Item>\r\n  </div>\r\n);\r\n\r\nconst renderListImage = imageToShows => {\r\n  let result = null;\r\n\r\n  if (imageToShows && imageToShows.length > 0) {\r\n    result = imageToShows.map((imageToShow, index) => (\r\n      <div key={index}>\r\n        <img src={`${config.API_IMAGES}${imageToShow}`} alt=\"Attach image\" />\r\n      </div>\r\n    ));\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nconst ProductDetail = ({\r\n  match: {\r\n    params: { id },\r\n  },\r\n  cookies,\r\n  user,\r\n  dispatch,\r\n}) => {\r\n  const [stateComment, setStateComment] = useState({\r\n    submitting: false,\r\n    value: '',\r\n  });\r\n  const [productItem, setProductItem] = useState({});\r\n\r\n  console.log(productItem);\r\n\r\n  const { accessToken } = cookies.cookies;\r\n\r\n  const handleSubmit = () => {\r\n    if (!stateComment.value) {\r\n      return;\r\n    }\r\n\r\n    setStateComment({\r\n      ...stateComment,\r\n      submitting: true,\r\n    });\r\n\r\n    setTimeout(() => {\r\n      setStateComment({\r\n        submitting: false,\r\n        value: '',\r\n      });\r\n    }, 500);\r\n\r\n    axios({\r\n      method: 'PATCH',\r\n      url: `${config.API_URL}/products/add-comment`,\r\n      headers: {\r\n        authorization: `Bearer ${accessToken}`,\r\n      },\r\n      data: {\r\n        product_id: id,\r\n        content: stateComment.value,\r\n        datetime: new Date(),\r\n      },\r\n    })\r\n      .then(res => {\r\n        setProductItem(res.data.results.product);\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  const handleChange = e => {\r\n    setStateComment({\r\n      ...stateComment,\r\n      value: e.target.value,\r\n    });\r\n  };\r\n\r\n  const handleRate = value => {\r\n    if (user && Object.keys(user).length > 0) {\r\n      axios({\r\n        method: 'PATCH',\r\n        url: `${config.API_URL}/products/rating`,\r\n        headers: {\r\n          authorization: `Bearer ${accessToken}`,\r\n        },\r\n        data: {\r\n          product_id: id,\r\n          point: value,\r\n        },\r\n      })\r\n        .then(res => {\r\n          setProductItem(res.data.results.product);\r\n        })\r\n        .catch(err => console.log(err));\r\n    } else {\r\n      dispatch(updateState({ isShowModalSignIn: true }));\r\n    }\r\n  };\r\n\r\n  const handleAddToCart = () => {\r\n    axios({\r\n      method: 'POST',\r\n      url: `${config.API_URL}/products/add-to-cart`,\r\n      headers: {\r\n        authorization: `Bearer ${accessToken}`,\r\n      },\r\n      data: {\r\n        product_id: id,\r\n      },\r\n    })\r\n      .then(res => {\r\n        message.success(`Thêm sản phẩm vào giỏ hàng thành công !`);\r\n      })\r\n      .catch(err => {\r\n        if (accessToken) {\r\n          message.warning('Sản phẩm đã có trong giỏ hàng !');\r\n        } else {\r\n          message.warning('Cần đăng nhập để thêm vào giỏ hàng !');\r\n        }\r\n      });\r\n  };\r\n\r\n  useEffect(() => {\r\n    axios({\r\n      method: 'GET',\r\n      url: `${config.API_URL}/products/${id}`,\r\n    })\r\n      .then(res => {\r\n        if (res.data.results.product) {\r\n          setProductItem(res.data.results.product);\r\n        }\r\n      })\r\n      .catch(err => console.log(err));\r\n  }, [id]);\r\n\r\n  if (JSON.stringify({}) !== JSON.stringify(productItem)) {\r\n    return (\r\n      <Fragment>\r\n        <div className={`${prefixCls}`}>\r\n          <div className={`${prefixCls}-image`}>\r\n            <Carousel infiniteLoop autoPlay transitionTime>\r\n              {renderListImage([\r\n                ...productItem.attachImages,\r\n                productItem.mainImage,\r\n              ])}\r\n            </Carousel>\r\n          </div>\r\n          <div className={`${prefixCls}-info`}>\r\n            <div className={`${prefixCls}-title`}>{productItem.name}</div>\r\n            <div className={`${prefixCls}-price`}>{`${numberToNumberWithCommas(\r\n              productItem.cost,\r\n            )}đ`}</div>\r\n            <div className={`${prefixCls}-rate`}>\r\n              <Rate\r\n                onChange={handleRate}\r\n                allowHalf\r\n                value={productItem.averagePoint}\r\n              />\r\n            </div>\r\n            <div className={`${prefixCls}-description`}>\r\n              <span>Mô tả:</span>\r\n              <p>{productItem.description}</p>\r\n            </div>\r\n            <div className={`${prefixCls}-quantity`}>\r\n              <Button onClick={handleAddToCart} type=\"primary\">\r\n                Thêm vào giỏ\r\n              </Button>\r\n            </div>\r\n          </div>\r\n          <div className={`${prefixCls}-comment`}>\r\n            {productItem.comments.length > 0 ? (\r\n              <CommentList\r\n                comments={productItem.comments.map(comment => ({\r\n                  ...comment,\r\n                  avatar:\r\n                    `${config.API_IMAGES}${comment.avatar}` ||\r\n                    config.IMAGE_USER_DEFAULT,\r\n                  datetime: moment(new Date(comment.datetime)).fromNow(),\r\n                }))}\r\n              />\r\n            ) : (\r\n              <div\r\n                style={{\r\n                  margin: '2rem auto 3rem',\r\n                  width: '80%',\r\n                  borderTop: '1px solid rgb(202, 202, 202)',\r\n                }}\r\n              ></div>\r\n            )}\r\n            <Comment\r\n              avatar={\r\n                <Avatar\r\n                  src={\r\n                    `${config.API_IMAGES}${user.avatar}` ||\r\n                    config.IMAGE_USER_DEFAULT\r\n                  }\r\n                  alt={user.full_name}\r\n                />\r\n              }\r\n              content={\r\n                <Editor\r\n                  onChange={handleChange}\r\n                  onSubmit={handleSubmit}\r\n                  submitting={stateComment.submitting}\r\n                  value={stateComment.value}\r\n                />\r\n              }\r\n            />\r\n          </div>\r\n        </div>\r\n      </Fragment>\r\n    );\r\n  } else {\r\n    return <Loading />;\r\n  }\r\n};\r\n\r\nconst mapStateToProps = ({ user }) => ({ user });\r\nconst mapDispatchToProps = dispatch => ({ dispatch });\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps,\r\n)(withCookies(ProductDetail));\r\n"],"sourceRoot":""}